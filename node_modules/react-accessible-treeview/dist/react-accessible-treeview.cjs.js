"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("classnames")),a=e(require("prop-types")),n=require("react"),l=e(n);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var n,l,r=[],d=!0,i=!1;try{for(a=a.call(e);!(d=(n=a.next()).done)&&(r.push(n.value),!t||r.length!==t);d=!0);}catch(e){i=!0,l=e}finally{try{d||null==a.return||a.return()}finally{if(i)throw l}}return r}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return o(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function u(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=c(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,l=function(){};return{s:l,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,d=!0,i=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return d=e.done,e},e:function(e){i=!0,r=e},f:function(){try{d||null==a.return||a.return()}finally{if(i)throw r}}}}function f(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a}var h=function(){},p=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){var a,n=u(t);try{for(n.s();!(a=n.n()).done;){var l=a.value;if(l&&l(e),e.defaultPrevented)break}}catch(e){n.e(e)}finally{n.f()}}},v=function(e,t){var a,n=new Set,l=u(e);try{for(l.s();!(a=l.n()).done;){var r=a.value;t.has(r)||n.add(r)}}catch(e){l.e(e)}finally{l.f()}return n},b=function(e,t){return new Set([].concat(s(v(e,t)),s(v(t,e))))},I=function(e){var t=n.useRef();return n.useEffect((function(){t.current=e}),[e]),t.current},S=function(e,t){var a;return!!(null===(a=k(e,t).children)||void 0===a?void 0:a.length)},y=function(e,t){return k(e,t).parent},g=function(e,t,a){for(var n=t,l=[];;){var r=y(e,n);if(0===r||null==r||null!=r&&a.has(r))break;l.push(r),n=r}return l},m=function(e,t,a){var n=[];return function e(t,l){var r=k(t,l);if(null!=r.children){var d,i=u(r.children.filter((function(e){return!a.has(e)})));try{for(i.s();!(d=i.n()).done;){var s=d.value;n.push(s),e(t,s)}}catch(e){i.e(e)}finally{i.f()}}}(e,t),n},w=function(e,t){var a=k(e,t);return null==a.children?[]:a.children},E=function(e,t,a){var n=y(e,t);if(null!=n){var l=k(e,n),r=l.children.indexOf(t)+a;if(l.children[r])return l.children[r]}return null},A=function(e,t,a){var n=k(e,t);for(L(e).id===t&&(n=k(e,k(e,t).children[k(e,t).children.length-1]));a.has(n.id)&&S(e,n.id);)n=k(e,n.children[n.children.length-1]);return n.id},O=function(e,t,a){if(t===L(e).children[0])return null;var n=E(e,t,-1);return null==n?y(e,t):A(e,n,a)},W=function(e,t,a){var n=k(e,t).id;if(S(e,n)&&a.has(n))return k(e,n).children[0];for(;;){var l=E(e,n,1);if(null!=l)return l;if(null==(n=y(e,n)))return null}},x=function(e){var t=e.data,a=e.expandedIds,n=e.from,l=e.to,r=[],d=t.length,i=0,s=n;if(r.push(n),n<l)for(;i<d&&(null!=(s=W(t,s,a))&&r.push(s),null!=s&&s!==l);)i+=1;else if(n>l)for(;i<d&&(null!=(s=O(t,s,a))&&r.push(s),null!=s&&s!==l);)i+=1;return r},T=function(e){var t=e.isSelected,a=e.isDisabled,n=e.multiSelect;return a||n?t:!!t||void 0},j=function(e){var t=e.isSelected,a=e.isDisabled,n=e.isHalfSelected,l=e.multiSelect;return a?t:n?"mixed":l?t:!!t||void 0},N=function(e,t,a){return t.concat.apply(t,s(t.filter((function(t){return S(e,t)})).map((function(t){return m(e,t,a)}))))},D=function(e,t,a){null!=t?window.navigator.userAgent.match(/Trident/)?setTimeout((function(){return!t.contains(document.activeElement)&&a()}),0):!t.contains(e.nativeEvent.relatedTarget)&&a():console.warn("ref not set on <ul>")},C=function(e,t,a){return S(e,t)&&a.has(t)&&m(e,t,new Set).some((function(e){return a.has(e)}))},U=function(e,t,a){var n=w(e,t);return S(e,t)&&!a.has(t)&&1===n.length&&n.every((function(e){return a.has(e)}))},M=function(e,t,a){var n=w(e,t);return S(e,t)&&a.has(t)&&1===n.length&&n.every((function(e){return a.has(e)}))},L=function(e){var t=e.find((function(e){return null===e.parent}));if(!t)throw Error("TreeView data must contain parent node.");return t},k=function(e,t){var a=e.find((function(e){return e.id===t}));if(null==a)throw Error("Node with id=".concat(t," doesn't exist in the tree."));return a},R=function(e){var t=Array.from(new Set(e));return e.length!==t.length},_="COLLAPSE",F="COLLAPSE_MANY",B="EXPAND",z="EXPAND_MANY",K="HALF_SELECT",H="SELECT",P="DESELECT",G="TOGGLE",V="TOGGLE_SELECT",q="SELECT_MANY",Y="EXCLUSIVE_CHANGE_SELECT_MANY",X="FOCUS",$="BLUR",J="DISABLE",Q="ENABLE",Z="CLEAR_MANUALLY_TOGGLED",ee="CONTROLLED_SELECT_MANY",te="UPDATE_TREE_STATE_WHEN_DATA_CHANGED",ae=function(e,t){switch(t.type){case _:var a=new Set(e.expandedIds);return a.delete(t.id),Object.assign(Object.assign({},e),{expandedIds:a,tabbableId:t.id,isFocused:!0,lastAction:t.type,lastInteractedWith:t.lastInteractedWith});case F:var n,l=new Set(e.expandedIds),r=u(t.ids);try{for(r.s();!(n=r.n()).done;){var d=n.value;l.delete(d)}}catch(e){r.e(e)}finally{r.f()}return Object.assign(Object.assign({},e),{expandedIds:l,lastAction:t.type,lastInteractedWith:t.lastInteractedWith});case B:var i=new Set(e.expandedIds);return i.add(t.id),Object.assign(Object.assign({},e),{expandedIds:i,tabbableId:t.id,isFocused:!0,lastAction:t.type,lastInteractedWith:t.lastInteractedWith});case z:var c=new Set([].concat(s(e.expandedIds),s(t.ids)));return Object.assign(Object.assign({},e),{expandedIds:c,lastAction:t.type,lastInteractedWith:t.lastInteractedWith});case G:var o=new Set(e.expandedIds);return e.expandedIds.has(t.id)?o.delete(t.id):o.add(t.id),Object.assign(Object.assign({},e),{expandedIds:o,tabbableId:t.id,isFocused:!0,lastAction:t.type,lastInteractedWith:t.lastInteractedWith});case K:if(e.disabledIds.has(t.id))return e;var f=new Set(e.halfSelectedIds),h=new Set(e.selectedIds);return f.add(t.id),h.delete(t.id),Object.assign(Object.assign({},e),{selectedIds:h,halfSelectedIds:f,tabbableId:t.keepFocus?e.tabbableId:t.id,lastAction:t.type,lastInteractedWith:t.lastInteractedWith,lastManuallyToggled:t.lastManuallyToggled,lastUserSelect:t.NotUserAction?e.lastUserSelect:t.id});case H:if(!t.NotUserAction&&e.disabledIds.has(t.id))return e;var p;t.multiSelect?(p=new Set(e.selectedIds)).add(t.id):(p=new Set).add(t.id);var b=new Set(e.halfSelectedIds);return b.delete(t.id),Object.assign(Object.assign({},e),{selectedIds:p,halfSelectedIds:b,tabbableId:t.keepFocus?e.tabbableId:t.id,isFocused:!0!==t.NotUserAction,lastUserSelect:t.NotUserAction?e.lastUserSelect:t.id,lastAction:t.type,lastInteractedWith:t.lastInteractedWith,lastManuallyToggled:t.lastManuallyToggled});case P:if(!t.NotUserAction&&e.disabledIds.has(t.id))return e;var I,S=new Set(e.selectedIds);return S.delete(t.id),t.multiSelect?(I=new Set(e.halfSelectedIds)).delete(t.id):I=new Set,Object.assign(Object.assign({},e),{selectedIds:S,halfSelectedIds:I,tabbableId:t.keepFocus?e.tabbableId:t.id,isFocused:!0,lastUserSelect:t.NotUserAction?e.lastUserSelect:t.id,lastAction:t.type,lastInteractedWith:t.lastInteractedWith,lastManuallyToggled:t.lastManuallyToggled});case V:if(e.disabledIds.has(t.id))return e;var y,g=e.selectedIds.has(t.id);t.multiSelect?(y=new Set(e.selectedIds),g?y.delete(t.id):y.add(t.id)):(y=new Set,g||y.add(t.id));var m=new Set(e.halfSelectedIds);return m.delete(t.id),Object.assign(Object.assign({},e),{selectedIds:y,halfSelectedIds:m,tabbableId:t.id,isFocused:!0,lastUserSelect:t.NotUserAction?e.lastUserSelect:t.id,lastAction:t.type,lastInteractedWith:t.lastInteractedWith,lastManuallyToggled:t.lastManuallyToggled});case q:var w,E=t.ids.filter((function(t){return!e.disabledIds.has(t)}));if(t.multiSelect){w=t.select?new Set([].concat(s(e.selectedIds),s(E))):v(e.selectedIds,new Set(E));var A=v(e.halfSelectedIds,w);return Object.assign(Object.assign({},e),{selectedIds:w,halfSelectedIds:A,lastAction:t.type,lastInteractedWith:t.lastInteractedWith,lastManuallyToggled:t.lastManuallyToggled})}return e;case Y:var O,W=t.ids.filter((function(t){return!e.disabledIds.has(t)}));if(t.multiSelect){O=t.select?new Set(W):v(e.selectedIds,new Set(W));var x=v(e.halfSelectedIds,O);return Object.assign(Object.assign({},e),{selectedIds:O,halfSelectedIds:x,lastAction:t.type,lastInteractedWith:t.lastInteractedWith,lastManuallyToggled:t.lastManuallyToggled})}return e;case ee:var T,j=e.lastInteractedWith,N=e.tabbableId;if(t.multiSelect)T=new Set(t.ids),t.ids.length&&(j=t.ids[t.ids.length-1],N=t.ids[t.ids.length-1]);else{T=new Set,t.ids.length>1&&console.warn("Tree in singleSelect mode, only the first item from selectedIds will be selected.");var D=t.ids[0];D&&T.add(D),j=null!=D?D:j,N=null!=D?D:j}var C=new Set(e.halfSelectedIds);t.ids.every((function(e){return C.delete(e)}));var U=new Set(t.ids);return Object.assign(Object.assign({},e),{selectedIds:T,halfSelectedIds:C,controlledIds:U,isFocused:!0,lastAction:t.type,tabbableId:N,lastInteractedWith:j});case X:return Object.assign(Object.assign({},e),{tabbableId:t.id,isFocused:!0,lastAction:t.type,lastInteractedWith:t.lastInteractedWith});case $:return Object.assign(Object.assign({},e),{isFocused:!1});case J:var M=new Set(e.disabledIds);return M.add(t.id),Object.assign(Object.assign({},e),{disabledIds:M});case Q:var L=new Set(e.disabledIds);return L.delete(t.id),Object.assign(Object.assign({},e),{disabledIds:L});case Z:return Object.assign(Object.assign({},e),{lastManuallyToggled:null});case te:return Object.assign(Object.assign({},e),{tabbableId:t.tabbableId,lastInteractedWith:t.lastInteractedWith,lastManuallyToggled:t.lastManuallyToggled,lastUserSelect:t.lastUserSelect});default:throw new Error("Invalid action passed to the reducer")}},ne={root:"tree",node:"tree-node",branch:"tree-node__branch",branchWrapper:"tree-branch-wrapper",leafListItem:"tree-leaf-list-item",leaf:"tree-node__leaf",nodeGroup:"tree-node-group"},le={select:"SELECT",focus:"FOCUS",exclusiveSelect:"EXCLUSIVE_SELECT"},re=Object.freeze(Object.values(le)),de=Object.freeze(Object.values({check:"check",select:"select"})),ie=function(e){var a=e.element,n=e.dispatch,r=e.data,i=e.selectedIds,c=e.tabbableId,o=e.isFocused,u=e.expandedIds,v=e.disabledIds,b=e.halfSelectedIds,I=e.lastUserSelect,y=e.nodeRefs,g=e.leafRefs,w=e.baseClassNames,E=e.nodeRenderer,A=e.nodeAction,O=e.setsize,W=e.posinset,D=e.level,U=e.propagateCollapse,L=e.propagateSelect,k=e.multiSelect,R=e.togglableSelect,_=e.clickAction,B=e.state,z=function(e){if(!(e.ctrlKey||e.altKey||e.shiftKey))if(u.has(a.id)&&U){var t=[a.id].concat(s(m(r,a.id,new Set)));n({type:F,ids:t,lastInteractedWith:a.id})}else n({type:G,id:a.id,lastInteractedWith:a.id})},P=function(){return n({type:X,id:a.id,lastInteractedWith:a.id})},$=function(e){if(e.shiftKey){var t=x({data:r,expandedIds:u,from:I,to:a.id}).filter((function(e){return!v.has(e)}));t=L?N(r,t,v):t,n({type:Y,select:!0,multiSelect:k,ids:t,lastInteractedWith:a.id,lastManuallyToggled:a.id})}else if(e.ctrlKey||_===le.select){var l=C(r,a.id,i),d=M(r,a.id,i);n({type:R?l&&!d?K:V:H,id:a.id,multiSelect:k,lastInteractedWith:a.id,lastManuallyToggled:a.id}),L&&!v.has(a.id)&&n({type:q,ids:N(r,[a.id],v),select:!R||!i.has(a.id),multiSelect:k,lastInteractedWith:a.id,lastManuallyToggled:a.id})}else _===le.exclusiveSelect?n({type:R?V:H,id:a.id,multiSelect:!1,lastInteractedWith:a.id,lastManuallyToggled:a.id}):_===le.focus&&n({type:X,id:a.id,lastInteractedWith:a.id})},J=function(e){var n;return t(e,(d(n={},"".concat(e,"--expanded"),u.has(a.id)),d(n,"".concat(e,"--selected"),i.has(a.id)),d(n,"".concat(e,"--focused"),c===a.id&&o),n))},Q="select"===A?{"aria-selected":T({isSelected:i.has(a.id),isDisabled:v.has(a.id),multiSelect:k})}:{"aria-checked":j({isSelected:i.has(a.id),isDisabled:v.has(a.id),isHalfSelected:b.has(a.id),multiSelect:k})};return S(r,a.id)||a.isBranch?l.createElement("li",Object.assign({role:"treeitem","aria-expanded":u.has(a.id),"aria-setsize":O,"aria-posinset":W,"aria-level":D,"aria-disabled":v.has(a.id),tabIndex:c===a.id?0:-1,ref:function(e){null!=(null==y?void 0:y.current)&&null!=e&&(y.current[a.id]=e)},className:w.branchWrapper},Q),l.createElement(l.Fragment,null,E({element:a,isBranch:!0,isSelected:i.has(a.id),isHalfSelected:b.has(a.id),isExpanded:u.has(a.id),isDisabled:v.has(a.id),dispatch:n,getNodeProps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onClick;return{onClick:null==n?p($,z,P):p(n,P),className:t(J(w.node),w.branch),ref:function(e){null!=(null==g?void 0:g.current)&&(g.current[a.id]=e)}}},setsize:O,posinset:W,level:D,handleSelect:$,handleExpand:z,treeState:B}),l.createElement(se,Object.assign({getClasses:J},function(e){e.setsize,e.posinset;return f(e,["setsize","posinset"])}(e))))):l.createElement("li",{role:"none",className:J(w.leafListItem)},E({element:a,isBranch:!1,isSelected:i.has(a.id),isHalfSelected:!1,isExpanded:!1,isDisabled:v.has(a.id),dispatch:n,getNodeProps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onClick;return Object.assign({role:"treeitem",tabIndex:c===a.id?0:-1,onClick:p(null==n?$:n,P),ref:function(e){null!=(null==y?void 0:y.current)&&null!=(null==g?void 0:g.current)&&(y.current[a.id]=e,g.current[a.id]=e)},className:t(J(w.node),w.leaf),"aria-setsize":O,"aria-posinset":W,"aria-level":D,disabled:v.has(a.id),"aria-disabled":v.has(a.id)},Q)},setsize:O,posinset:W,level:D,handleSelect:$,handleExpand:h,treeState:B}))},se=function(e){var t=e.data,a=e.element,n=e.expandedIds,d=e.getClasses,i=e.baseClassNames,s=e.level,c=f(e,["data","element","expandedIds","getClasses","baseClassNames","level"]);return l.createElement("ul",{role:"group",className:d(i.nodeGroup)},n.has(a.id)&&a.children.length>0&&a.children.map((function(e,d){return l.createElement(ie,Object.assign({data:t,expandedIds:n,baseClassNames:i,key:"".concat(e,"-").concat(r(e)),element:k(t,e),setsize:a.children.length,posinset:d+1,level:s+1},c))})))},ce=function(e){var t=e.data,a=e.controlledSelectedIds,l=e.controlledExpandedIds,r=e.defaultExpandedIds,d=e.defaultSelectedIds,c=e.defaultDisabledIds,o=e.nodeRefs,f=e.leafRefs,p=e.onSelect,w=e.onNodeSelect,E=e.onExpand,A=e.onLoadData,O=e.togglableSelect,W=e.multiSelect,x=e.propagateSelect,T=e.propagateSelectUpwards,j=L(t),D=i(n.useReducer(ae,{selectedIds:new Set(a||d),controlledIds:new Set(a),tabbableId:j.children[0],isFocused:!1,expandedIds:new Set(l||r),halfSelectedIds:new Set,lastUserSelect:j.children[0],lastInteractedWith:null,lastManuallyToggled:null,disabledIds:new Set(c)}),2),C=D[0],M=D[1],R=C.selectedIds,V=C.controlledIds,Y=C.expandedIds,$=C.disabledIds,J=C.tabbableId,Q=C.halfSelectedIds,ne=C.lastAction,le=C.lastInteractedWith,re=C.lastManuallyToggled,de=I(R)||new Set,ie=b(R,de);n.useEffect((function(){var e;if(null!=p&&p!==h){var a,n=u(ie);try{for(n.s();!(a=n.n()).done;){var l=a.value,r=S(t,l)||!!(null===(e=k(t,J))||void 0===e?void 0:e.isBranch);p({element:k(t,l),isBranch:r,isExpanded:!!r&&Y.has(l),isSelected:R.has(l),isDisabled:$.has(l),isHalfSelected:!!r&&Q.has(l),treeState:C})}}catch(e){n.e(e)}finally{n.f()}}}),[t,R,Y,$,Q,ie,p,C]),n.useEffect((function(){null!=w&&w!==h&&null!=re&&ie.size&&(w({element:k(t,re),isSelected:R.has(re),isBranch:S(t,re),treeState:C}),M({type:Z}))}),[re,R,ie]);var se=I(Y)||new Set;n.useEffect((function(){var e=b(Y,se);if(null!=E&&E!==h){var a,n=u(e);try{for(n.s();!(a=n.n()).done;){var l=a.value;E({element:k(t,l),isExpanded:Y.has(l),isSelected:R.has(l),isDisabled:$.has(l),isHalfSelected:Q.has(l),treeState:C})}}catch(e){n.e(e)}finally{n.f()}}}),[t,R,Y,$,Q,se,E,C]);var ce,oe,ue=(ce=t,oe=n.useRef(),n.useEffect((function(){oe.current=ce})),oe.current||new Map);n.useEffect((function(){var e=b(Y,se);if(A){var a,n=u(e);try{for(n.s();!(a=n.n()).done;){var l=a.value;A({element:k(t,l),isExpanded:Y.has(l),isSelected:R.has(l),isDisabled:$.has(l),isHalfSelected:Q.has(l),treeState:C})}}catch(e){n.e(e)}finally{n.f()}if(ue!==t&&O&&x){var r,d=u(Y);try{for(d.s();!(r=d.n()).done;){var i=r.value;R.has(i)&&M({type:q,ids:N(t,[i],$),select:!0,multiSelect:W,lastInteractedWith:i})}}catch(e){d.e(e)}finally{d.f()}}}}),[t,R,Y,$,Q,se,A,C]),n.useEffect((function(){if(ue!==t){var e=L(t);e.children.length&&M({type:te,tabbableId:t.find((function(e){return e.id===C.tabbableId}))?C.tabbableId:e.children[0],lastInteractedWith:t.find((function(e){return e.id===C.lastInteractedWith}))?C.lastInteractedWith:null,lastManuallyToggled:t.find((function(e){return e.id===C.lastManuallyToggled}))?C.lastManuallyToggled:null,lastUserSelect:t.find((function(e){return e.id===C.lastUserSelect}))?C.lastUserSelect:e.children[0]})}}),[t]);var fe=b(new Set(a),V);return n.useEffect((function(){if(a){fe.size&&M({type:ee,ids:a,multiSelect:W});var e,n=u(a);try{for(n.s();!(e=n.n()).done;){var l=e.value;x&&!$.has(l)&&M({type:q,ids:N(t,[l],$),select:!0,multiSelect:W,lastInteractedWith:l})}}catch(e){n.e(e)}finally{n.f()}}}),[a]),n.useEffect((function(){var e=new Set(l),a=v(e,se),n=v(se,e);if(n.size){var r,d=u(n);try{for(d.s();!(r=d.n()).done;){var i=r.value;if(S(t,i)||k(t,i).isBranch){var c=[i].concat(s(m(t,i,new Set)));M({type:F,ids:c,lastInteractedWith:i})}}}catch(e){d.e(e)}finally{d.f()}}if(a.size){var o,f=u(a);try{for(f.s();!(o=f.n()).done;){var h=o.value;if(S(t,h)||k(t,h).isBranch){var p=y(t,h);M(p?{type:z,ids:[h,p],lastInteractedWith:h}:{type:B,id:h,lastInteractedWith:h})}}}catch(e){f.e(e)}finally{f.f()}}}),[l]),n.useEffect((function(){if(T){var e=new Set([].concat(s(ie),s(V)));le&&ne!==X&&ne!==_&&ne!==B&&ne!==G&&e.add(le);var a=[];e.forEach((function(e){t.find((function(t){return t.id===e}))||a.push(e)})),a.forEach((function(t){return e.delete(t)}));var n,l=function(e,t,a,n,l,r){var d,i={every:new Set,some:new Set,none:new Set},s=u(t);try{for(s.s();!(d=s.n()).done;)for(var c=d.value;;){var o=y(e,c);if(0===o||null==o||null!=o&&n.has(o))break;var f=k(e,o).children.filter((function(e){return!n.has(e)}));if(0===f.length)break;if(f.some((function(e){return a.has(e)||i.some.has(e)||l.has(e)})))f.every((function(e){return a.has(e)}))?i.every.add(o):i.some.add(o);else{var h=g(e,c,n).find((function(e){return a.has(e)}));if(!r&&h){m(e,h,n).forEach((function(e){l.has(e)&&i.none.add(e)}));break}i.none.add(o)}c=o}}catch(e){s.e(e)}finally{s.f()}return i}(t,e,R,$,Q,W),r=l.every,d=l.some,i=l.none,c=u(r);try{for(c.s();!(n=c.n()).done;){var o=n.value;R.has(o)||M({type:H,id:o,multiSelect:W||U(t,o,R),keepFocus:!0,NotUserAction:!0,lastInteractedWith:le})}}catch(e){c.e(e)}finally{c.f()}var f,h=u(d);try{for(h.s();!(f=h.n()).done;){var p=f.value;Q.has(p)||M({type:K,id:p,lastInteractedWith:le,keepFocus:!0,NotUserAction:!0})}}catch(e){h.e(e)}finally{h.f()}var v,b=u(i);try{for(b.s();!(v=b.n()).done;){var I=v.value;(R.has(I)||Q.has(I))&&M({type:P,id:I,multiSelect:W,keepFocus:!0,NotUserAction:!0,lastInteractedWith:le,lastManuallyToggled:re})}}catch(e){b.e(e)}finally{b.f()}}}),[t,W,T,R,Y,$,Q,ne,de,ie,le,fe]),n.useEffect((function(){if(null!=le&&null!=J&&null!=(null==o?void 0:o.current)&&null!=(null==f?void 0:f.current)){var e=o.current[J];!function(e){null!=e&&e.scrollIntoView&&e.scrollIntoView({block:"nearest"})}(f.current[le]),function(e){null!=e&&e.focus&&e.focus({preventScroll:!0})}(e)}}),[J,o,f,le]),[C,M]},oe=l.forwardRef((function(e,a){var d=e.data,s=e.selectedIds,c=e.nodeRenderer,o=e.onSelect,u=void 0===o?h:o,p=e.onNodeSelect,v=void 0===p?h:p,b=e.onExpand,I=void 0===b?h:b,S=e.onLoadData,y=e.className,g=void 0===y?"":y,m=e.multiSelect,w=void 0!==m&&m,E=e.propagateSelect,A=void 0!==E&&E,O=e.propagateSelectUpwards,W=void 0!==O&&O,x=e.propagateCollapse,T=void 0!==x&&x,j=e.expandOnKeyboardSelect,N=void 0!==j&&j,C=e.togglableSelect,U=void 0!==C&&C,M=e.defaultExpandedIds,_=void 0===M?[]:M,F=e.defaultSelectedIds,B=void 0===F?[]:F,z=e.defaultDisabledIds,K=void 0===z?[]:z,H=e.clickAction,P=void 0===H?le.select:H,G=e.nodeAction,V=void 0===G?"select":G,q=e.expandedIds,Y=e.onBlur,X=f(e,["data","selectedIds","nodeRenderer","onSelect","onNodeSelect","onExpand","onLoadData","className","multiSelect","propagateSelect","propagateSelectUpwards","propagateCollapse","expandOnKeyboardSelect","togglableSelect","defaultExpandedIds","defaultSelectedIds","defaultDisabledIds","clickAction","nodeAction","expandedIds","onBlur"]);!function(e){if(R(e.map((function(e){return e.id}))))throw Error("Multiple TreeView nodes have the same ID. IDs must be unique.");if(e.forEach((function(e){if(e.id===e.parent)throw Error("Node with id=".concat(e.id," has parent reference to itself."));if(R(e.children))throw Error("Node with id=".concat(e.id," contains duplicate ids in its children."))})),0===e.filter((function(e){return null===e.parent})).length)throw Error("TreeView must have one root node.");if(e.filter((function(e){return null===e.parent})).length>1)throw Error("TreeView can have only one root node.");L(e).children.length||console.warn("TreeView have no nodes to display.")}(d);var J=n.useRef({}),Q=n.useRef({}),Z=i(ce({data:d,controlledSelectedIds:s,controlledExpandedIds:q,defaultExpandedIds:_,defaultSelectedIds:B,defaultDisabledIds:K,nodeRefs:J,leafRefs:Q,onSelect:u,onNodeSelect:v,onExpand:I,onLoadData:S,togglableSelect:U,multiSelect:w,propagateSelect:A,propagateSelectUpwards:W}),2),ee=Z[0],te=Z[1];A=A&&w;var ae=n.useRef(null);return null!=a&&(ae=a),l.createElement("ul",Object.assign({className:t(ne.root,g),role:"tree","aria-multiselectable":"select"===V?w:void 0,ref:ae,onBlur:function(e){D(e,ae.current,(function(){Y&&Y({treeState:ee,dispatch:te}),te({type:$})}))},onKeyDown:ue({data:d,tabbableId:ee.tabbableId,expandedIds:ee.expandedIds,selectedIds:ee.selectedIds,disabledIds:ee.disabledIds,halfSelectedIds:ee.halfSelectedIds,clickAction:P,dispatch:te,propagateCollapse:T,propagateSelect:A,multiSelect:w,expandOnKeyboardSelect:N,togglableSelect:U})},X),L(d).children.map((function(e,t){return l.createElement(ie,Object.assign({key:"".concat(e,"-").concat(r(e)),data:d,element:k(d,e),setsize:L(d).children.length,posinset:t+1,level:1},ee,{state:ee,dispatch:te,nodeRefs:J,leafRefs:Q,baseClassNames:ne,nodeRenderer:c,propagateCollapse:T,propagateSelect:A,propagateSelectUpwards:W,multiSelect:w,togglableSelect:U,clickAction:P,nodeAction:V}))})))})),ue=function(e){var t=e.data,a=e.expandedIds,n=e.selectedIds,l=e.disabledIds,r=e.tabbableId,d=e.dispatch,i=e.propagateCollapse,c=e.propagateSelect,o=e.multiSelect,u=e.expandOnKeyboardSelect,f=e.togglableSelect,h=e.clickAction;return function(e){var p=k(t,r),v=p.id;if(e.ctrlKey){if("a"===e.key){e.preventDefault();var b=t.filter((function(e){return null!==e.parent})).map((function(e){return e.id})).filter((function(e){return!l.has(e)}));d({type:q,multiSelect:o,select:Array.from(n).filter((function(e){return!l.has(e)})).length!==b.length,ids:b,lastInteractedWith:p.id})}else if(e.shiftKey&&("Home"===e.key||"End"===e.key)){var I="Home"===e.key?L(t).children[0]:A(t,v,a),g=x({data:t,expandedIds:a,from:v,to:I}).filter((function(e){return!l.has(e)}));d({type:q,multiSelect:o,select:!0,ids:c?N(t,g,l):g}),d({type:X,id:I,lastInteractedWith:I})}}else{if(e.shiftKey)switch(e.key){case"ArrowUp":e.preventDefault();var w=O(t,v,a);return void(null==w||l.has(w)||(d({type:q,ids:c?N(t,[w],l):[w],select:!0,multiSelect:o,lastInteractedWith:w,lastManuallyToggled:w}),d({type:X,id:w,lastInteractedWith:w})));case"ArrowDown":e.preventDefault();var E=W(t,v,a);return void(null==E||l.has(E)||(d({type:q,ids:c?N(t,[E],l):[E],multiSelect:o,select:!0,lastInteractedWith:E,lastManuallyToggled:E}),d({type:X,id:E,lastInteractedWith:E})))}switch(e.key){case"ArrowDown":e.preventDefault();var T=W(t,v,a);return void(null!=T&&d({type:X,id:T,lastInteractedWith:T}));case"ArrowUp":e.preventDefault();var j=O(t,v,a);return void(null!=j&&d({type:X,id:j,lastInteractedWith:j}));case"ArrowLeft":if(e.preventDefault(),(S(t,v)||p.isBranch)&&a.has(r))if(i){var D=[v].concat(s(m(t,v,new Set)));d({type:F,ids:D,lastInteractedWith:p.id})}else d({type:_,id:v,lastInteractedWith:v});else if(!L(t).children.includes(v)){var U=y(t,v);if(null==U)throw new Error("parentId of root element is null");d({type:X,id:U,lastInteractedWith:U})}return;case"ArrowRight":return e.preventDefault(),void((S(t,v)||p.isBranch)&&(a.has(r)?d({type:X,id:p.children[0],lastInteractedWith:p.children[0]}):d({type:B,id:v,lastInteractedWith:v})));case"Home":e.preventDefault(),d({type:X,id:L(t).children[0],lastInteractedWith:L(t).children[0]});break;case"End":e.preventDefault();var R=A(t,L(t).id,a);return void d({type:X,id:R,lastInteractedWith:R});case"*":e.preventDefault();var P=y(t,v);if(null==P)throw new Error("parentId of element is null");var Y=k(t,P).children.filter((function(e){return S(t,e)||k(t,e).isBranch}));return void d({type:z,ids:Y,lastInteractedWith:v});case"Enter":case" ":case"Spacebar":if(e.preventDefault(),h===le.focus)return;var $=C(t,p.id,n),J=M(t,p.id,n);return d({type:f?$&&!J?K:V:H,id:v,multiSelect:o,lastInteractedWith:v,lastManuallyToggled:v}),c&&!l.has(p.id)&&d({type:q,ids:N(t,[v],l),select:!f||!n.has(v),multiSelect:o,lastInteractedWith:v,lastManuallyToggled:v}),void(u&&d({type:G,id:v,lastInteractedWith:v}));default:if(1===e.key.length)for(var Q=W(t,v,a);Q!==v;)if(null!=Q){if(k(t,Q).name[0].toLowerCase()===e.key.toLowerCase())return void d({type:X,id:Q,lastInteractedWith:v});Q=W(t,Q,a)}else Q=L(t).children[0];return}}}};oe.propTypes={data:a.array.isRequired,onSelect:a.func,onNodeSelect:a.func,onExpand:a.func,className:a.string,nodeRenderer:a.func.isRequired,defaultExpandedIds:a.array,defaultSelectedIds:a.array,expandedIds:a.array,selectedIds:a.array,defaultDisabledIds:a.array,propagateCollapse:a.bool,propagateSelect:a.bool,propagateSelectUpwards:a.bool,multiSelect:a.bool,expandOnKeyboardSelect:a.bool,togglableSelect:a.bool,nodeAction:a.oneOf(de),clickAction:a.oneOf(re),onBlur:a.func,onLoadData:a.func},exports.CLICK_ACTIONS=re,exports.default=oe,exports.flattenTree=function(e){var t=0,a=[];return function e(n,l){var r,d={id:n.id||t,name:n.name,children:[],parent:l,metadata:n.metadata?Object.assign({},n.metadata):void 0};if(a.find((function(e){return e.id===d.id})))throw Error("Multiple TreeView nodes have the same ID (".concat(d.id,"). IDs must be unique."));if(a.push(d),t+=1,null===(r=n.children)||void 0===r?void 0:r.length){var i,s=u(n.children);try{for(s.s();!(i=s.n()).done;){e(i.value,d.id)}}catch(e){s.e(e)}finally{s.f()}var c,o=u(a.values());try{for(o.s();!(c=o.n()).done;){var f=c.value;f.parent===d.id&&d.children.push(f.id)}}catch(e){o.e(e)}finally{o.f()}}}(e,null),a};
