{
  "hash": "9d1eb0f266029e8c704ec8e2fdf9a6c5",
  "result": {
    "markdown": "---\ntitle: \"Shiny App Styling\"\ndescription: \"During my interview process with Bloomreach, I wanted to showcase the power of R for web app development in an easily accessible manner. I built a Shiny app and styled it 'a la Bloomreach' and now I'd like to help you do the same to demo the power of R + Shiny to prospective employers.\"\ndate: 10-27-2022\ncategories: [shiny, github, bslib, docker]\nimage: images/Shiny_Demo_Preview.png\n---\n\n\n# Background\n\nIf you Google Search \"applying for jobs is,\" you see auto-completion suggestions that feel about right...![](./images/google_auto_suggestions.png)\n\nApplying for jobs is both exhausting *and* a full-time job. Data scientists are expected to stay on top of their statistical education, have robust GitHub repositories, and they're expected to know how to apply ever-changing technologies for DevOps and reproducible machine learning... And all this in addition to the endless resume and cover letter tweaks you're probably making for each job (as you should).\n\nIf you're an academic wanting to pivot to industry or a data scientist looking for a job change, I propose a simple (*or simple-ish*) solution to standing out from the crowd in a meaningful way: Build an easy-to-access web application for your future employers.\n\nIn July 2022, [Travis Gerke](https://www.linkedin.com/in/travisgerke/) held a presentation at rstudio::conf(2022) titled [*What They Forgot to Teach You About Industry Transitions from Academia*](https://www.rstudio.com/conference/2022/talks/wtf-teach-you-industry/) (or \"WTF-AITA\" ðŸ˜¬). Travis presented my Shiny app as a \"cover letter accessory\" and it motivated me to write this tutorial such that anybody familiar with R, GitHub, and the RStudio IDE could deploy their own demo Shiny app for prospective employers.\n\n# Steps to Edit the App\n\nTo ensure a smooth installation, I recommend installing the latest version of R (4.2.2) and the latest version of the RStudio IDE. The underlying R scripts used on this Shiny app rely on the native pipe operator (`|>`) introduced in base R 4.1.0. If you do not have access to the native pipe, you will not be able to run the app without additional code tweaks, i.e., replacing all instances of the native pipe (`|>`) with the `magrittr` pipe (`%>%`).\n\n::: callout-warning\n## Git for the R User\n\nThe next steps assume that you're familiar with GitHub, you've installed R + [Git](https://github.com/git-guides/install-git) + the [RStudio IDE](https://posit.co/download/rstudio-desktop/), and you've connected RStudio to GitHub. Jenny Bryan's [*Happy Git and GitHub for the useR*](https://happygitwithr.com/rstudio-git-github.html) is a great resource if you're stuck on any of these topics.\n:::\n\n::: callout-note\n## Docker\n\nIf you're not an R user, you can still clone this project's GitHub repo, edit files as needed, and build a Docker image. Skip to the Docker section of this post if you plan on building a Docker image from the Dockerfile included in this project's GitHub repo.\n:::\n\n## 1: Clone Repo\n\nWe'll start by forking this GitHub repo into your repository to allow you to experiment with my code without actually changing anything in my original project repo. To do this, navigate to my GitHub repo ( [JavOrraca/bslib_demo_shiny](https://github.com/JavOrraca/bslib_demo_shiny)) and click on the `Fork` button in the top-right of the repo. This will prompt you to \"Create a new fork\" - Typically, I like to keep all of the defaults intact. When you're ready to create the new fork, simply hit the `Create fork` button on the bottom of the screen.\n\nAssuming you kept the original repository name, you should see a newly created repo titled \"bslib_demo_shiny\" in your GitHub repositories. It contains a full copy of all files and folders found in my original project repo.\n\nNext, you'll want to clone this repo to your local machine. Using the RStudio IDE, navigate to its menu bar and click on `File` -> `New Project` -> `Version Control` -> `Git`, copy/paste your repo's clone URL, choose your local project directory path of choice, and click on `Create Project`.\n\nRStudio IDE's *New Project Wizard* will launcn in a popup window after selecting `New Project` from the file menu. You should expect the following:\n\n![](./images/clone_git_repo.gif){fig-align=\"center\" width=\"65%\"}\n\nThis process will create a local clone of all files and folders found on your remote GitHub repo. Once all files are downloaded for this project, the files and folder structure will look like this:\n\nâ”œâ”€â”€ Dockerfile\n<br>â”œâ”€â”€ LICENSE\n<br>â”œâ”€â”€ README.md\n<br>â”œâ”€â”€ bslib_demo_shiny.Rproj\n<br>â”œâ”€â”€ global.R\n<br>â”œâ”€â”€ helpers\n<br>â”‚   â”œâ”€â”€ custom_theme.R\n<br>â”‚   â”œâ”€â”€ footer.R\n<br>â”‚   â””â”€â”€ navbar.R\n<br>â”œâ”€â”€ modules\n<br>â”‚   â”œâ”€â”€ mod_About.R\n<br>â”‚   â”œâ”€â”€ mod_Mapping.R\n<br>â”‚   â”œâ”€â”€ mod_Overview.R\n<br>â”‚   â””â”€â”€ mod_Reports.R\n<br>â”œâ”€â”€ renv\n<br>â”‚   â”œâ”€â”€ activate.R\n<br>â”‚   â”œâ”€â”€ library\n<br>â”‚   â”‚   â””â”€â”€ R-4.2\n<br>â”‚   â”œâ”€â”€ sandbox\n<br>â”‚   â”‚   â””â”€â”€ R-4.2\n<br>â”‚   â”œâ”€â”€ settings.dcf\n<br>â”‚   â””â”€â”€ staging\n<br>â”œâ”€â”€ renv.lock\n<br>â”œâ”€â”€ server.R\n<br>â”œâ”€â”€ ui.R\n<br>â”œâ”€â”€ www\n<br>â”‚   â”œâ”€â”€ Shiny_Demo_Preview.png\n<br>â”‚   â”œâ”€â”€ blr_logo-primary.png\n<br>â”‚   â””â”€â”€ styles.scss\n\n## 2: Install Packages\n\nIt's important to make note of the `renv` folder. This Shiny app relies on the [`renv`](https://rstudio.github.io/renv/articles/renv.html) package to manage project-package dependencies. If the Shiny app requires different package versions than those installed on your system's main R library path, this approach will install the necessary packages in the `renv` directory.\n\nTo install the required R packages for this app, follow the instructions presented in your RStudio IDE Console immediately after cloning the GitHub repo or execute the command `renv::restore()`. This process will restore the package state as recorded in the `renv.lock` file - This \"lockfile\" records all of the R package names and versions required to run this specific Shiny app.\n\nOnce the project-package dependencies are installed, test launch the Shiny app by running `shiny::runApp()` in the Console or by clicking on the `Run App` button in the RStudio IDE. The `Run App` button only appears if you're inside the `global.R`, `ui.R`, and `server.R` files - These three filenames are unique to Shiny and the RStudio IDE recognizes them as such.\n\n![](./images/run_app.gif){fig-align=\"center\"}\n\n## 3: App Customization\n\nWhile there are many ways to configure a Shiny app, the global aesthetics of this app have been configured using the [`bslib`](https://rstudio.github.io/bslib/) and [`thematic`](https://rstudio.github.io/thematic/) packages. These packages provide tools for customizing Bootstrap themes and they introduce Sass variables to Shiny (in my opinion, making the customization process much more unified).\n\nThe default Bootstrap version for `bslib` is version 5, however, this app was designed using Bootstrap 4. The `thematic` package provides a centralized approach to certain R visualizations such as those generated from `ggplot2`.\n\nTo fully customize the appearance of the app to your liking, make revisions to the following files that are sourced at runtime:\n\n### `helpers/custom_theme.R`\n\nThis helper file creates two functions (`fn_custom_theme()` and `fn_thematic_theme()`) that are loaded into your global environment at runtime. Here you can specify base fonts, background (`bg`) and foreground (`fg`) colors, and other accent colors used throughout the Shiny app. The `fn_custom_theme()` function is called in line 3 of `ui.R` (in the app's root directory) and the `fn_thematic_theme()` function is called in line 56 of `modules/mod_Overview.R`.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"true\"}\n# Overarching bslib theme\nfn_custom_theme <- function() {\n  bslib::bs_theme(\n    version = \"4\",\n    base_font = sass::font_google(\"Open Sans\"),\n    bg = \"#ffffff\",\n    fg = \"#1d2d42\",\n    primary = \"#f3d436\", \n    secondary = \"#1d2d42\",\n    success = \"#1d2d42\") |> \n    bs_add_variables(\"border-bottom-width\" = \"6px\",\n                     \"border-color\" = \"$primary\",\n                     .where = \"declarations\") |> \n    bs_add_rules(sass::sass_file(\"www/styles.scss\"))\n}\n\n# Thematic theme for ggplot2 outputs\nfn_thematic_theme <- function() {\n  thematic::thematic_theme(\n    bg = \"#ffffff\",\n    fg = \"#1d2d42\",\n    accent = \"#f3d436\",\n    font = font_spec(sass::font_google(\"Open Sans\"), scale = 1.75)\n  )\n}\n```\n:::\n\n\n### `helpers/footer.R`\n\nThis file creates the `fn_footer()` helper function that powers the Shiny app's footer. The `fn_footer()` function uses Shiny `tags` in conjunction with `htmltools::HTML()` (exported to the `shiny` package) to create an HTML footer tag that can process raw HTML. I've used it to include my name and website in the footer and the `fn_footer()` function is called in line 7 of `ui.R`.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"true\"}\nfn_footer <- function(){\n  tags$footer(\n    HTML(\n      \"This web app demo was developed by <a href='https://www.javierorracadeatcu.com'>Javier Orraca-Deatcu</a> with R + Shiny\"\n    )\n  )\n}\n```\n:::\n\n\n### `helpers/navbar.R`\n\nThis script sets the navigation bar's branding (logo and hyperlink) and wraps it into the helper function `fn_navbar()`. This function is passed to the `title` argument on line 5 of `ui.R` and it creates an HTML `div` with a custom `class` attribute (`bloomreach_logo`) that can be further styled with CSS in the `www/styles.scss` \"Sassy CSS\" file.\n\n::: callout-tip\n## About Shiny's www folder\n\nThe image path in line 5, below, does not specify a full path despite this image existing in the `www` folder. In Shiny projects, the `www` directory is used for storing elements that will be rendered in the web browser and not from script outputs. We do not need to include the full path on line 5 of `helpers/navbar.R` as Shiny knows to look for `blr_logo-primary.png` in the `www` folder.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"true\"}\nfn_navbar <- function(){\n  div(\n    class = \"bloomreach_logo\",\n    a(href = \"https://www.bloomreach.com/\",\n      img(src = \"blr_logo-primary.png\",\n          title = \"Bloomreach\")\n    )\n  )\n}\n```\n:::\n\n\n### `modules/About.R`\n\nThis script defines the UI and Server functions used to render the *About* page on the Shiny app. Technically, the *Overview*, *Mapping*, *Reports*, and *About* pages of the Shiny app are tabs toggled with `shiny::tabPanel()`. Now that you've had some exposure to `htmltools::HTML()`, you should be able to revise the raw HTML in this script to build your own *About* page. It's fairly straightforward so I won't show this module in a code chunk - Please reach out to me directly or in the comments section you have any questions.\n\n## 4: Example Tweaks\n\nNow that we've covered the files in your Shiny project that need to be updated if you want to deploy your own custom-styled demo Shiny app, let's pivot to a real world example. Let's say our name is Steve Wozniak and we want to design a Shiny app that invokes a retro Apple feel... After finding a decent logo to use and saving it to `www/retro_apple_logo.png`, below are the steps that we would need to follow to update our app:\n\n* `helpers/custom_theme.R`\n  * Line 5: `base_font = sass::font_google(\"Press Start 2P\", local = FALSE, display = \"swap\"),`\n  * Line 8: `primary = \"#01c700\",`\n  * Line 22: `accent = \"#01c700\",`\n* `helpers/footer.R`\n  * Line 4: `\"This web app demo was developed by <a href='http://www.woz.org/'>Steve Wozniak</a> with R + Shiny\"`\n* `helpers/navbar.R`\n  * Line 3: `class = \"retro_apple\",`\n  * Line 4: `a(href = \"http://www.apple.com/\",`\n  * Line 5: `img(src = \"retro_apple_logo.png\",`\n  * Line 6: `title = \"Apple\")`\n\nLet's give this app a test run and see how it changed the appearance:\n\n![](./images/run_revised_app.gif){fig-align=\"center\"}\n\nSo far, so good! We've got a retro logo (re-sized to fit in the top-left of the navbar), a retro font (pulled from Google Fonts), and the primary and accent colors have been updated from yellow to neon green. There are several additional edits we *could* make but for now, I like it.\n\n## 5: App Deployment\n\nNow we're ready to publish your newly revised Shiny app. We'll use the [shinyapps.io](https://www.shinyapps.io/) platform by Posit to push-button deploy our app from the RStudio IDE. For our needs, a free account will suffice as the free tier allows up to 5 Shiny app deployments with a combined 25 monthly active hours of usage. It's important to note that if someone launches your app and keeps it running in a tab, this is considered \"active\" runtime, so encourage your shinyapps.io users to close the browser window when they're done using your app.\n\nIf you do not have a shinyapps.io account or you have not synced your RStudio IDE to shinyapps.io via security token, please review the shinyapps.io [Getting Started](https://docs.posit.co/shinyapps.io/getting-started.html#working-with-shiny-for-r) documentation. Once you're set up, it will be a breeze to publish your app. If you're stuck, again feel free to reach out to me directly.\n\nSimilar to the way that the `Run App` button will present itself if you're inside the `global.R`, `ui.R`, or `server.R` files, you'll also see a blue sync-looking button that gives you the power of push-button deployment from within the RStudio IDE:\n\n![](./images/publish_button.png)\n<br>Clicking that button will open a new window to help you publish your app to the shinyapps.io servers. The title you select will be the name of the application on your shinyapps.io dashboard and it will also be included in the URL of your app. For example, I named my app \"Bloomreach_Shiny_App\" so the URL to visit my app is [https://javierorraca.shinyapps.io/Bloomreach_Shiny_App/](https://javierorraca.shinyapps.io/Bloomreach_Shiny_App/).\n\n![](./images/publish_to_server.png){fig-align=\"center\" width=\"75%\"}\n\nIf you use a title that already exists in your shinyapps.io dashboard, you will force overwrite the prior app with the same name, so take caution when publishing. More often than not, it's desired to overwrite an app so that you can regularly push updates to production to the same URL, however, there are instances where this behavior would not be desired. Regardless of your publishing intention, RStudio IDE will provide a warning to confirm that you want to write over a shinyapps.io application with the same name.\n\nSince the `Dockerfile` is not relevant to this project deployment, I recommend unchecking `Dockerfile` from the list of file from which to publish. Once you're ready, click on `Publish` and a new tab, *Deploy*, will be visible in the bottom-left of your RStudio IDE. This process takes several minutes since shinyapps.io will 1) install an R image with all the project-package dependencies needed to run your Shiny app, and 2) build and deploy the Shiny app itself. Once publishing is complete, you should see something like this:\n\n![](./images/deploy_pane.png){fig-align=\"center\" width=\"85%\"} <br>\n\n## 6: Git Commit & Push\n\nNow that you've successfully published your application from the RStudio IDE, wrap up your changes and commit / push them back to your GitHub repo. There are several ways to do this (GitHub Desktop app, Terminal, Windows Powershell, etc.) but I've found the easiest to be within the RStudio IDE. First, you'll want to commit (or save) a local snapshot of the edits you've made from the remote GitHub repo. Since this commit is saved locally, you'll also need to push this commit back to your GitHub repo.\n\nUnder the *Git* pane, click on `Commit` to open a window that allows you to inspect the files that were modified, added, deleted, etc. The quickest way to stage all files for commit is to click on any of the filenames you editted in the top-left pane of the commit popup window, select all files using the *Select All* keystroke (Ctrl+A on Windows or Cmd+A on Mac), then click on the `Stage` button. Write a message in the blank top-right message box for this commit - Keep it succinct about the file(s) changes that you've made. Click on the `Commit` button under the message box and this saves a local snapshot of the changes you've made.\n\nTo push the changes back to GitHub, click on the green `Push` button in the top-right of the commit window and this will push your locally committed changes to your remote GitHub repo. Now, in addition to the live app that you've deployed, you'll also be able to direct end users to your GitHub repo with your app's source code.\n\n# Docker\n\n\n\n# Shiny Session Info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nR version 4.2.2 (2022-10-31)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Ventura 13.0.1\n\nMatrix products: default\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] rsconnect_0.8.28   leaflet_2.1.1      DT_0.26            thematic_0.1.2.1  \n [5] bslib_0.4.1        shinyWidgets_0.7.4 scales_1.2.1       showtext_0.9-5    \n [9] showtextdb_3.0     sysfonts_0.8.8     ggplot2_3.3.6      purrr_0.3.5       \n[13] dplyr_1.0.10       rlang_1.0.6        shiny_1.7.3       \n\nloaded via a namespace (and not attached):\n [1] tidyselect_1.2.0        splines_4.2.2           lattice_0.20-45        \n [4] leaflet.providers_1.9.0 colorspace_2.0-3        vctrs_0.5.0            \n [7] generics_0.1.3          htmltools_0.5.3         yaml_2.3.6             \n[10] mgcv_1.8-41             utf8_1.2.2              later_1.3.0            \n[13] pillar_1.8.1            jquerylib_0.1.4         glue_1.6.2             \n[16] withr_2.5.0             lifecycle_1.0.3         munsell_0.5.0          \n[19] gtable_0.3.1            fontawesome_0.4.0       htmlwidgets_1.5.4      \n[22] memoise_2.0.1           labeling_0.4.2          fastmap_1.1.0          \n[25] httpuv_1.6.6            crosstalk_1.2.0         fansi_1.0.3            \n[28] Rcpp_1.0.9              xtable_1.8-4            renv_0.16.0            \n[31] promises_1.2.0.1        cachem_1.0.6            jsonlite_1.8.3         \n[34] mime_0.12               farver_2.1.1            fs_1.5.2               \n[37] digest_0.6.30           grid_4.2.2              cli_3.4.1              \n[40] tools_4.2.2             magrittr_2.0.3          sass_0.4.2             \n[43] tibble_3.1.8            pkgconfig_2.0.3         Matrix_1.5-1           \n[46] ellipsis_0.3.2          rstudioapi_0.14         R6_2.5.1               \n[49] nlme_3.1-160            compiler_4.2.2              \n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}